<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Double Pendulum (p5.js)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
</head>
<body>
<script>

// let g = 900.81;

// // lengths
// let L1 = 150;
// let L2 = 150;

// // masses
// let m1 = 1;
// let m2 = 1;

// // angles (radians)
// let theta1 = Math.PI / 2;
// let theta2 = Math.PI / 2;

// // angular velocities
// let omega1 = 0;
// let omega2 = 0;

// // time step
// let dt = 0.02;

// // trail
// let trail = [];

// function setup() {
//   createCanvas(600, 600);
//   pixelDensity(2);
// }

// function draw() {
//   background(0, 20); // slight fade for trail

//   let originX = width / 2;
//   let originY = 150;

//   // --- equations of motion ---
//   let delta = theta2 - theta1;

//   let denom1 = (m1 + m2) * L1 - m2 * L1 * cos(delta) * cos(delta);
//   let denom2 = (L2 / L1) * denom1;

//   let a1 = (
//     m2 * L1 * omega1 * omega1 * sin(delta) * cos(delta) +
//     m2 * g * sin(theta2) * cos(delta) +
//     m2 * L2 * omega2 * omega2 * sin(delta) -
//     (m1 + m2) * g * sin(theta1)
//   ) / denom1;

//   let a2 = (
//     -m2 * L2 * omega2 * omega2 * sin(delta) * cos(delta) +
//     (m1 + m2) * g * sin(theta1) * cos(delta) -
//     (m1 + m2) * L1 * omega1 * omega1 * sin(delta) -
//     (m1 + m2) * g * sin(theta2)
//   ) / denom2;

//   // integrate
//   omega1 += a1 * dt;
//   omega2 += a2 * dt;

//   theta1 += omega1 * dt;
//   theta2 += omega2 * dt;

//   // positions
//   let x1 = originX + L1 * sin(theta1);
//   let y1 = originY + L1 * cos(theta1);

//   let x2 = x1 + L2 * sin(theta2);
//   let y2 = y1 + L2 * cos(theta2);

//   // store trail
//   trail.push({x: x2, y: y2});
//   if (trail.length > 2000) trail.shift();

//   // draw trail
//   stroke(255, 100, 100);
//   noFill();
//   beginShape();
//   for (let p of trail) vertex(p.x, p.y);
//   endShape();

//   // draw rods
//   stroke(255);
//   strokeWeight(2);
//   line(originX, originY, x1, y1);
//   line(x1, y1, x2, y2);

//   // draw masses
//   fill(255);
//   circle(x1, y1, 10);
//   circle(x2, y2, 10);
// }

// let m1, m2, r1, r2;
// let a1, a2;
// let a1_v = 0, a2_v = 0;
// let g = 1;

// let started = false;

// // UI elements
// let a1Slider, a2Slider;
// let r1Slider, r2Slider;
// let m1Slider, m2Slider;
// let startButton;

// function setup() {
//   createCanvas(800, 600);
//   angleMode(RADIANS);

//   // --- SlIDERS ---
//   a1Slider = createSlider(0, PI, PI / 2, 0.01);
//   a2Slider = createSlider(0, PI, PI / 2, 0.01);

//   r1Slider = createSlider(50, 200, 150, 1);
//   r2Slider = createSlider(50, 200, 150, 1);

//   m1Slider = createSlider(5, 40, 20, 1);
//   m2Slider = createSlider(5, 40, 20, 1);

//   // --- BUTTON ---
//   startButton = createButton("Start Simulation");
//   startButton.mousePressed(startSimulation);

//   // Layout
//   let y = 20;
//   createP("Angle 1").position(20, y); a1Slider.position(120, y); y += 30;
//   createP("Angle 2").position(20, y); a2Slider.position(120, y); y += 30;
//   createP("Length 1").position(20, y); r1Slider.position(120, y); y += 30;
//   createP("Length 2").position(20, y); r2Slider.position(120, y); y += 30;
//   createP("Mass 1").position(20, y); m1Slider.position(120, y); y += 30;
//   createP("Mass 2").position(20, y); m2Slider.position(120, y); y += 40;

//   startButton.position(20, y);
// }

// function startSimulation() {
//   // Read values ONCE
//   a1 = a1Slider.value();
//   a2 = a2Slider.value();
//   r1 = r1Slider.value();
//   r2 = r2Slider.value();
//   m1 = m1Slider.value();
//   m2 = m2Slider.value();

//   a1_v = 0;
//   a2_v = 0;

//   started = true;
// }

// function draw() {
//   background(20);
//   translate(width / 2, height / 3);

//   if (started) {
//     updatePhysics();
//   }

//   drawPendulum();
// }

// function updatePhysics() {
//   let num1 = -g * (2 * m1 + m2) * sin(a1);
//   let num2 = -m2 * g * sin(a1 - 2 * a2);
//   let num3 = -2 * sin(a1 - a2) * m2;
//   let num4 = a2_v * a2_v * r2 + a1_v * a1_v * r1 * cos(a1 - a2);
//   let den = r1 * (2 * m1 + m2 - m2 * cos(2 * a1 - 2 * a2));
//   let a1_a = (num1 + num2 + num3 * num4) / den;

//   num1 = 2 * sin(a1 - a2);
//   num2 = a1_v * a1_v * r1 * (m1 + m2);
//   num3 = g * (m1 + m2) * cos(a1);
//   num4 = a2_v * a2_v * r2 * m2 * cos(a1 - a2);
//   den = r2 * (2 * m1 + m2 - m2 * cos(2 * a1 - 2 * a2));
//   let a2_a = (num1 * (num2 + num3 + num4)) / den;

//   a1_v += a1_a;
//   a2_v += a2_a;

//   a1 += a1_v;
//   a2 += a2_v;
// }

// function drawPendulum() {
//   let x1 = r1 * sin(a1);
//   let y1 = r1 * cos(a1);

//   let x2 = x1 + r2 * sin(a2);
//   let y2 = y1 + r2 * cos(a2);

//   stroke(255);
//   strokeWeight(2);
//   line(0, 0, x1, y1);
//   line(x1, y1, x2, y2);

//   fill(200);
//   ellipse(x1, y1, m1, m1);
//   ellipse(x2, y2, m2, m2);
// }




// ===============================
// Double Pendulum (RK4 Integrator)
// ===============================



// =====================================
// Double Pendulum — RK4 (FIXED VERSION)
// =====================================

// =====================================
// Double Pendulum — RK4 (CANONICAL)
// =====================================


// =======================================
// Double Pendulum — RK4 (ROBUST VERSION)
// =======================================



// =======================================
// Double Pendulum — RK4 (STATE-SAFE)
// =======================================




</script>
<link rel="stylesheet" href="style.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="script.js"></script>
</body>
</html>
